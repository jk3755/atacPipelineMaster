library(ChIPseeker)
library(genomation)
library(GenomicRanges)
library(clusterProfiler)
library(org.Hs.eg.db)
library(TxDb.Hsapiens.UCSC.hg38.knownGene)
txdb <- TxDb.Hsapiens.UCSC.hg38.knownGene
bedFile <- "C:\\Users\\jsk33\\Documents\\atac\\atac1\\mdst8\\wt01\\peaks\\macs2\\merged\\MDST8-WT-01-merged_local_normalization_peaks.narrowPeak"
## Peak annotation
peakAnno <- annotatePeak(bedFile, tssRegion=c(-3000, 3000), TxDb=txdb, annoDb="org.Hs.eg.db")
## Distribution of TF-binding loci relative to TSS
plotDistToTSS(peakAnno, title="Distribution of transcription factor-binding loci\nrelative to TSS")
##
#install.packages("BiocManager")
library(BiocManager)
#iocManager::install("ChIPseeker")
#BiocManager::install("genomation")
#BiocManager::install("GenomicRanges")
#BiocManager::install("clusterProfiler")
#BiocManager::install("TxDb.Hsapiens.UCSC.hg38.knownGene")
#BiocManager::install("org.Hs.eg.db")
BiocManager::install("ReactomePA")
library(ReactomePA)
pathway1 <- enrichPathway(as.data.frame(peakAnno)$geneId)
head(pathway1, 2)
## Data mining with ChIP seq data deposited in GEO
getGEOspecies()
hg38 <- getGEOInfo(genome="hg38", simplify=TRUE)
head(hg38)
narrowPeaks <- ChIPseeker::readPeakFile(bedFile)
narrowPeaks <- keepStandardChromosomes(narrowPeaks, pruning.mode="coarse")
View(narrowPeaks)
View(narrowPeaks)
narrowPeaks@elementMetadata@listData[["X189"]]
narrowPeaks@elementMetadata@listData[["X486"]]
covplot(narrowPeaks, weightCol="X486")
peakAnno <- annotatePeak(bedFile, tssRegion=c(-3000, 3000), TxDb=txdb, annoDb="org.Hs.eg.db")
## Distribution of TF-binding loci relative to TSS
plotDistToTSS(peakAnno, title="Distribution of transcription factor-binding loci\nrelative to TSS")
genes= lapply(peakAnno, function(i) as.data.frame(i)$geneId)
vennplot(genes)
load("~/atac/atac1/mdst8/wt01/footprints/parsed/MDST8-WT-01.OVOL1.motif1.info.Rdata")
View(parsedSitesInfo)
View(parsedSitesInfo)
